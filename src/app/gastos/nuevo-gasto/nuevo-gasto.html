<div class="min-h-screen">
  <!-- Header -->
  <div class="header-container">
    <div class="header-card">
      <div class="header-content">
        <div class="icon-title">
          <div class="icon-box">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="1" x2="12" y2="23"></line>
              <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
          </div>
          <h1>Nuevo Gasto</h1>
        </div>
        <button class="btn-regresar" routerLink="/gastos">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
          <span class="hide-mobile">Regresar</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Form Container -->
  <div class="form-container">
    <div class="form-card">
      <div class="form-header">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        <h2>Informaci√≥n del Gasto</h2>
      </div>

      <!-- Loading Categor√≠as -->
      <div *ngIf="isLoadingCategorias" class="alert-info">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
        </svg>
        Cargando categor√≠as...
      </div>

      <form #gastoForm="ngForm" (ngSubmit)="createGasto()">
        <!-- Grid Layout -->
        <div class="form-grid">
          <!-- Monto -->
          <div class="form-group">
            <label class="form-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
              Monto *
            </label>
            <div class="input-wrapper">
              <span class="input-prefix">$</span>
              <input
                type="number"
                name="amount"
                [(ngModel)]="nuevoGasto.amount"
                placeholder="0.00"
                step="0.01"
                min="0.01"
                required
                class="form-input"
                [class.input-error]="gastoForm.submitted && !nuevoGasto.amount"
                [disabled]="isLoading"
                #amount="ngModel">
            </div>
            <p *ngIf="gastoForm.submitted && !nuevoGasto.amount" class="error-message">
              El monto debe ser mayor a 0
            </p>
          </div>

          <!-- Fecha -->
          <div class="form-group">
            <label class="form-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
              </svg>
              Fecha *
            </label>
            <input
              type="date"
              name="expenseDate"
              [(ngModel)]="nuevoGasto.expenseDate"
              required
              class="form-input"
              [class.input-error]="gastoForm.submitted && !nuevoGasto.expenseDate"
              [disabled]="isLoading"
              #expenseDate="ngModel">
            <p *ngIf="gastoForm.submitted && !nuevoGasto.expenseDate" class="error-message">
              Seleccione una fecha
            </p>
          </div>
        </div>

        <!-- Categor√≠a -->
        <div class="form-group">
          <label class="form-label">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
              <line x1="7" y1="7" x2="7.01" y2="7"></line>
            </svg>
            Categor√≠a *
          </label>
      <select
  name="expenseCategoryId"
  [(ngModel)]="nuevoGasto.expenseCategoryId"
  required
  class="form-input"
  [class.input-error]="gastoForm.submitted && (!nuevoGasto.expenseCategoryId || nuevoGasto.expenseCategoryId === 0)"
  [disabled]="isLoading || isLoadingCategorias"
  #category="ngModel">
  <option [ngValue]="0">Seleccione una categor√≠a</option>
  <option *ngFor="let cat of categoriasGasto" [ngValue]="cat.categoryId">
    {{ cat.name }}
    <span *ngIf="cat.description"> - {{ cat.description }}</span>
  </option>
</select>

<!-- Mensaje si no hay categor√≠as -->
<div *ngIf="!isLoadingCategorias && categoriasGasto.length === 0" class="alert-warning">
  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <circle cx="12" cy="12" r="10"></circle>
    <line x1="12" y1="8" x2="12" y2="12"></line>
    <line x1="12" y1="16" x2="12.01" y2="16"></line>
  </svg>
  No hay categor√≠as de gasto disponibles.
  <a routerLink="/categorias" class="link-primary">Crear una nueva categor√≠a</a>
</div>

          <p *ngIf="gastoForm.submitted && (!nuevoGasto.expenseCategoryId || nuevoGasto.expenseCategoryId === 0)" class="error-message">
            Seleccione una categor√≠a
          </p>
        </div>

        <!-- Descripci√≥n -->
        <div class="form-group">
          <label class="form-label">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
            Descripci√≥n *
          </label>
          <textarea
            name="description"
            [(ngModel)]="nuevoGasto.description"
            placeholder="Describe el gasto..."
            rows="4"
            required
            class="form-input"
            [class.input-error]="gastoForm.submitted && !nuevoGasto.description"
            [disabled]="isLoading"
            #description="ngModel"></textarea>
          <p *ngIf="gastoForm.submitted && !nuevoGasto.description" class="error-message">
            La descripci√≥n es obligatoria
          </p>
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="alert-error">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="15" y1="9" x2="9" y2="15"></line>
            <line x1="9" y1="9" x2="15" y2="15"></line>
          </svg>
          {{ errorMessage }}
        </div>

        <!-- Buttons -->
        <div class="button-group">
          <button
            type="submit"
            [disabled]="isLoading || isLoadingCategorias || categoriasGasto.length === 0"
            class="btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
              <polyline points="17 21 17 13 7 13 7 21"></polyline>
              <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
            {{ isLoading ? 'Guardando...' : 'Guardar Gasto' }}
          </button>
          <button
            type="button"
            (click)="limpiarFormulario()"
            [disabled]="isLoading"
            class="btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
            Limpiar
          </button>
        </div>
      </form>
    </div>

    <!-- Info Card -->
    <div class="info-card">
      <p>
        <span class="tip-badge">üí° Tip:</span> Aseg√∫rate de llenar todos los campos marcados con * para registrar tu gasto correctamente.
      </p>
      <p *ngIf="categoriasGasto.length > 0" style="margin-top: 0.5rem;">
        <span class="tip-badge">üìä</span> Tienes {{ categoriasGasto.length }} categor√≠a(s) de gasto disponible(s).
      </p>
    </div>
  </div>
</div>
